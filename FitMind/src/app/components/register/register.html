<section class="auth">
  <div class="register-container">
    <h1>Vytvor si ÃºÄet</h1>
    <p class="subtitle">ZaÄni svoju fitness cestu s FitMind</p>

    <form (ngSubmit)="register()" class="register-form">
      <!-- Krok 1: ZÃ¡kladnÃ© Ãºdaje -->
      @if (currentStep === 1) {
        <div class="form-section">
          <h3>ğŸ“‹ ZÃ¡kladnÃ© Ãºdaje</h3>
          
          <div class="form-row">
            <mat-form-field appearance="outline" class="half-width">
              <mat-label>Meno</mat-label>
              <input matInput [(ngModel)]="profile.firstName" name="firstName" required />
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width">
              <mat-label>Priezvisko</mat-label>
              <input matInput [(ngModel)]="profile.lastName" name="lastName" required />
            </mat-form-field>
          </div>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>E-mail</mat-label>
            <input matInput type="email" [(ngModel)]="email" name="email" required />
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Heslo</mat-label>
            <input matInput type="password" [(ngModel)]="password" name="password" required />
          </mat-form-field>

          <div class="form-row">
            <mat-form-field appearance="outline" class="half-width">
              <mat-label>Vek</mat-label>
              <input matInput type="number" [(ngModel)]="profile.age" name="age" required />
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width">
              <mat-label>Pohlavie</mat-label>
              <mat-select [(ngModel)]="profile.gender" name="gender" required>
                <mat-option value="male">MuÅ¾</mat-option>
                <mat-option value="female">Å½ena</mat-option>
                <mat-option value="other">InÃ©</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>
      }

      <!-- Krok 2: FyzickÃ© parametre -->
      @if (currentStep === 2) {
        <div class="form-section">
          <h3>ğŸ“ FyzickÃ© parametre</h3>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>VÃ½Å¡ka (cm)</mat-label>
            <input matInput type="number" [(ngModel)]="profile.height" name="height" required />
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>AktuÃ¡lna vÃ¡ha (kg)</mat-label>
            <input matInput type="number" [(ngModel)]="profile.currentWeight" name="currentWeight" required />
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>CieÄ¾ovÃ¡ vÃ¡ha (kg)</mat-label>
            <input matInput type="number" [(ngModel)]="profile.targetWeight" name="targetWeight" required />
          </mat-form-field>

          <div class="bmi-display">
            <p>Tvoje BMI: <strong>{{ calculateBMI() }}</strong></p>
          </div>
        </div>
      }

      <!-- Krok 3: Fitness ciele -->
      @if (currentStep === 3) {
        <div class="form-section">
          <h3>ğŸ¯ Tvoje ciele</h3>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>HlavnÃ½ cieÄ¾</mat-label>
            <mat-select [(ngModel)]="profile.fitnessGoal" name="fitnessGoal" required>
              <mat-option value="lose_weight">ğŸ”¥ SchudnÃºÅ¥</mat-option>
              <mat-option value="gain_muscle">ğŸ’ª NabraÅ¥ svalovÃº hmotu</mat-option>
              <mat-option value="maintain">âš–ï¸ UdrÅ¾aÅ¥ vÃ¡hu</mat-option>
              <mat-option value="improve_health">â¤ï¸ ZlepÅ¡iÅ¥ zdravie</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>ÃšroveÅˆ aktivity</mat-label>
            <mat-select [(ngModel)]="profile.activityLevel" name="activityLevel" required>
              <mat-option value="sedentary">ğŸª‘ SedavÃ½ (mÃ¡lo pohybu)</mat-option>
              <mat-option value="light">ğŸš¶ Ä½ahko aktÃ­vny (1-3 dni/tÃ½Å¾deÅˆ)</mat-option>
              <mat-option value="moderate">ğŸƒ Stredne aktÃ­vny (3-5 dnÃ­/tÃ½Å¾deÅˆ)</mat-option>
              <mat-option value="active">ğŸ‹ï¸ AktÃ­vny (6-7 dnÃ­/tÃ½Å¾deÅˆ)</mat-option>
              <mat-option value="very_active">âš¡ VeÄ¾mi aktÃ­vny (2x denne)</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>ZdravotnÃ© obmedzenia (voliteÄ¾nÃ©)</mat-label>
            <textarea matInput [(ngModel)]="medicalConditionsText" name="medicalConditions" rows="3" 
              placeholder="Napr.: cukrovka, vysokÃ½ tlak..."></textarea>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>DiÃ©tne obmedzenia (voliteÄ¾nÃ©)</mat-label>
            <textarea matInput [(ngModel)]="dietaryRestrictionsText" name="dietaryRestrictions" rows="3"
              placeholder="Napr.: laktÃ³za, gluten, vegetariÃ¡n..."></textarea>
          </mat-form-field>
        </div>
      }

      <!-- ChybovÃ© hlÃ¡senie -->
      @if (errorMsg) {
        <div class="error-box">
          {{ errorMsg }}
        </div>
      }

      <!-- NavigaÄnÃ© tlaÄidlÃ¡ -->
      <div class="button-group">
        @if (currentStep > 1) {
          <button mat-stroked-button type="button" (click)="previousStep()">
            â† SpÃ¤Å¥
          </button>
        }

        @if (currentStep < 3) {
          <button mat-flat-button color="primary" type="button" (click)="nextStep()">
            Äalej â†’
          </button>
        }

        @if (currentStep === 3) {
          <button mat-flat-button color="primary" type="submit" [disabled]="isLoading">
            {{ isLoading ? 'VytvÃ¡ram ÃºÄet...' : 'âœ“ VytvoriÅ¥ ÃºÄet' }}
          </button>
        }
      </div>

      <!-- Progress indicator -->
      <div class="progress-dots">
        <span class="dot" [class.active]="currentStep === 1"></span>
        <span class="dot" [class.active]="currentStep === 2"></span>
        <span class="dot" [class.active]="currentStep === 3"></span>
      </div>
    </form>

    <p class="link">
      UÅ¾ mÃ¡Å¡ ÃºÄet?
      <a routerLink="/login">PrihlÃ¡s sa</a>
    </p>
  </div>
</section>
